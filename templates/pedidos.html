{% extends "base.html" %}

{% block title %}Pedidos - PetRoyale{% endblock %}

{% block content %}
<section class="orders-section">
    <h1 class="orders-title">üì¶ Pedidos</h1>
    <h2 class="orders-subtitle">Listado de pedidos</h2>

    {% if pedidos_con_detalles %}
        <table class="orders-table">
            <thead>
                <tr>
                    <th>N√∫mero de Pedido</th>
                    <th>Fecha</th>
                    <th>Estado</th>
                    <th>Total con IVA</th>
                    <th>Producto/s</th>
                    <th>Precio Unitario</th>
                </tr>
            </thead>
            <tbody>
                {% for item in pedidos_con_detalles %}
                    {% for detalle in item.detalles %}
                        <tr>
                            {% if forloop.first %}
                                <td rowspan="{{ item.detalles|length }}">{{ item.pedido.numero_pedido }}</td>
                                <td rowspan="{{ item.detalles|length }}">{{ item.pedido.fecha_pedido|date:"d/m/Y H:i" }}</td>
                                <td rowspan="{{ item.detalles|length }}">{{ item.pedido.estado }}</td>
                                <td rowspan="{{ item.detalles|length }}">{{ item.pedido.total_con_iva }}‚Ç¨</td>
                            {% endif %}
                            <td>{{ detalle.cantidad }} x {{ detalle.producto.nombre }}</td>
                            <td>{{ detalle.precio_unitario }}‚Ç¨ c/u</td>                            
                        </tr>
                    {% endfor %}
                {% endfor %}
            </tbody>
                                   
        </table>
    {% else %}
        <p class="orders-text">No hay ning√∫n pedido.</p>
    {% endif %}

    <a href="{% url 'Tienda' %}" class="btn-create">üõçÔ∏è Hacer nuevo pedido</a>
</section>
{% endblock %}
